{% extends "base.html" %}

{% block title %}{{name}} - Monster{% endblock %}

{% block styles %}
<link rel="stylesheet" href="styles/monster.css">
{% endblock %}

{% block content %}
<main id="monster" class="container-fluid">
  <section class="stat-block">
    <!-- Header: Name, Level/Size, Armor, HP -->
    <div class="monster-header">
      <div class="monster-header-left">
        <span class="monster-name">{{name}}</span>
        <span class="monster-level">LVL {{data.level|default: '—'}}{% if data.size %},{% endif %} {{data.size|default: 'Medium'|map: 'Size'|uppercase}}</span>
      </div>
      <div class="monster-header-right">
        {% if data.isLegendary == true %}
        <!-- Legendary: HP, Armor, Saves -->
        <span class="monster-hp"><svg class="icon icon-heart" viewBox="0 0 296.37 296.37" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M121.069,247.456c-28.267-17.661-90.827-58.345-103.146-79.932 C1.871,139.436-3.649,123.13,2.377,95.336c2.856-13.244,8.496-23.676,13.63-30.975c5.183-7.375,15.958-17.525,23.954-21.68 c8.072-4.194,19.885-8.289,35.615-8.648c33.815,0,52.884,12.771,62.821,23.198c6.217,6.521,12.423,6.472,18.602-0.087 c9.981-10.595,29.36-23.513,64.208-22.719c15.719,0.348,27.533,4.433,35.61,8.632c7.995,4.161,18.77,14.31,23.905,21.718 c4.988,7.196,10.454,17.465,13.282,30.562c6.005,27.794,0.495,44.1-15.529,72.187c-12.352,21.593-74.907,62.272-103.174,79.932 c-7.642,4.77-18.759,14.957-27.081,14.881C139.904,262.272,128.71,252.226,121.069,247.456z"/></svg>{{data.hp.max|default: '—'}}</span>
        {% if data.armor %}<span class="monster-armor"><svg class="icon icon-shield" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.4167C3 7.21907 3 5.62028 3.37752 5.08241C3.75503 4.54454 5.25832 4.02996 8.26491 3.00079L8.83772 2.80472C10.405 2.26824 11.1886 2 12 2C12.8114 2 13.595 2.26824 15.1623 2.80472L15.7351 3.00079C18.7417 4.02996 20.245 4.54454 20.6225 5.08241C21 5.62028 21 7.21907 21 10.4167C21 10.8996 21 11.4234 21 11.9914C21 17.6294 16.761 20.3655 14.1014 21.5273C13.38 21.8424 13.0193 22 12 22C10.9807 22 10.62 21.8424 9.89856 21.5273C7.23896 20.3655 3 17.6294 3 11.9914C3 11.4234 3 10.8996 3 10.4167Z"/></svg>{{data.armor}}</span>{% endif %}
        {% if data.saves %}<span class="monster-saves"><svg class="icon icon-star" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.9121 1.59053C12.7508 1.2312 12.3936 1 11.9997 1C11.6059 1 11.2487 1.2312 11.0874 1.59053L8.27041 7.86702L1.43062 8.60661C1.03903 8.64895 0.708778 8.91721 0.587066 9.2918C0.465355 9.66639 0.574861 10.0775 0.866772 10.342L5.96556 14.9606L4.55534 21.6942C4.4746 22.0797 4.62768 22.4767 4.94632 22.7082C5.26497 22.9397 5.68983 22.9626 6.03151 22.7667L11.9997 19.3447L17.968 22.7667C18.3097 22.9626 18.7345 22.9397 19.0532 22.7082C19.3718 22.4767 19.5249 22.0797 19.4441 21.6942L18.0339 14.9606L23.1327 10.342C23.4246 10.0775 23.5341 9.66639 23.4124 9.2918C23.2907 8.91721 22.9605 8.64895 22.5689 8.60661L15.7291 7.86702L12.9121 1.59053Z"/></svg>{{data.saves}}</span>{% endif %}
        {% else %}
        <!-- Normal: Armor, HP, Movement -->
        {% if data.armor %}<span class="monster-armor"><svg class="icon icon-shield" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.4167C3 7.21907 3 5.62028 3.37752 5.08241C3.75503 4.54454 5.25832 4.02996 8.26491 3.00079L8.83772 2.80472C10.405 2.26824 11.1886 2 12 2C12.8114 2 13.595 2.26824 15.1623 2.80472L15.7351 3.00079C18.7417 4.02996 20.245 4.54454 20.6225 5.08241C21 5.62028 21 7.21907 21 10.4167C21 10.8996 21 11.4234 21 11.9914C21 17.6294 16.761 20.3655 14.1014 21.5273C13.38 21.8424 13.0193 22 12 22C10.9807 22 10.62 21.8424 9.89856 21.5273C7.23896 20.3655 3 17.6294 3 11.9914C3 11.4234 3 10.8996 3 10.4167Z"/></svg>{{data.armor}}</span>{% endif %}
        <span class="monster-hp"><svg class="icon icon-heart" viewBox="0 0 296.37 296.37" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M121.069,247.456c-28.267-17.661-90.827-58.345-103.146-79.932 C1.871,139.436-3.649,123.13,2.377,95.336c2.856-13.244,8.496-23.676,13.63-30.975c5.183-7.375,15.958-17.525,23.954-21.68 c8.072-4.194,19.885-8.289,35.615-8.648c33.815,0,52.884,12.771,62.821,23.198c6.217,6.521,12.423,6.472,18.602-0.087 c9.981-10.595,29.36-23.513,64.208-22.719c15.719,0.348,27.533,4.433,35.61,8.632c7.995,4.161,18.77,14.31,23.905,21.718 c4.988,7.196,10.454,17.465,13.282,30.562c6.005,27.794,0.495,44.1-15.529,72.187c-12.352,21.593-74.907,62.272-103.174,79.932 c-7.642,4.77-18.759,14.957-27.081,14.881C139.904,262.272,128.71,252.226,121.069,247.456z"/></svg>{{data.hp.max|default: '—'}}</span>
        {% if data.movement.type %}<span class="monster-movement"><svg class="icon icon-arrow" viewBox="0 0 512.01 512.01" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M505.754,240.923L271.088,6.256c-3.989-4.011-9.408-6.251-15.083-6.251H21.338c-8.619,0-16.427,5.184-19.712,13.163 c-3.307,7.979-1.472,17.152,4.629,23.253l219.584,219.584L6.256,475.59c-6.101,6.101-7.936,15.275-4.629,23.253 c3.285,7.979,11.093,13.163,19.712,13.163h234.667c5.675,0,11.093-2.24,15.083-6.251l234.667-234.667 C514.096,262.747,514.096,249.264,505.754,240.923z"/></svg>{{data.movement.type|map: 'MovementType'}} {{data.movement.speed}}</span>{% endif %}
        {% endif %}
      </div>
    </div>

    <!-- Short Description (italic) -->
    {% if data.shortDescription %}
    <div class="monster-description">{{data.shortDescription}}</div>
    {% endif %}

    <!-- Traits -->
    {% if data.traits %}
    <div class="monster-traits-wrapper">
      <div class="monster-traits">
        {{data.traits|md}}
      </div>
    </div>
    {% endif %}

    <!-- Core Stats (Speed only - armor/size moved to header) -->
    {% if data.movement.speed %}
    <div class="monster-stats">
      <span><strong>Speed</strong> {{data.movement.speed}}{% if data.movement.type %} ({{data.movement.type|map: 'MovementType'}}){% endif %}</span>
    </div>
    <hr class="monster-divider">
    {% endif %}

    <!-- Actions -->
    {% if data.actions %}
    <div class="monster-section">
      {% if data.actionFrequency %}
      <div class="monster-section-title">Actions: <span class="monster-action-frequency">{{data.actionFrequency}}</span></div>
      {% endif %}
      <div class="monster-actions">
        {% for action in data.actions %}
        <span class="monster-action">
          <strong>{{action.name}}.</strong> {{action.text|md}}
        </span>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Bloodied -->
    {% if data.isLegendary == true and data.bloodied.abilities %}
    <hr class="monster-divider">
    <div class="monster-section">
      <span class="monster-action">
        <strong>BLOODIED:</strong> {{data.bloodied.abilities|md}}
      </span>
    </div>
    {% endif %}

    <!-- Last Stand -->
    {% if data.isLegendary == true and data.lastStand.behavior %}
    <div class="monster-section">
      <span class="monster-action">
        <strong>LAST STAND:</strong> {{data.lastStand.behavior|md}}
      </span>
    </div>
    {% endif %}

  </section>

  <!-- Description & Notes -->
  <section class="other">
    {% if descr %}
    <div class="monster-description-full">
      {{descr|md}}
    </div>
    {% endif %}

    {% if notes %}
    <h3>Notes</h3>
    {{notes|md}}
    {% endif %}

    {% if image %}
    <a href="{{env.dataURL}}{{image}}" target="_blank">
      <img class="monster-image" src="{{env.dataURL}}{{image}}" />
    </a>
    {% endif %}
  </section>
</main>
{% endblock %}
